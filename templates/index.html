{% extends "base.html" %}

{% block content %}
<header>
    <h1>Daily Health Log</h1>
    <p>Submit daily log to get AI advice.</p>
</header>

<form id="predictionForm">
    <div class="form-container">
        
        <div class="form-column">
            <h3><i class="fas fa-user"></i> Profile</h3>
            
            <div class="form-group">
                <label>Date of Sleep Log:</label>
                <input type="date" id="logDate" required>
            </div>

            <div class="form-group">
                <label for="gender">Gender:</label>
                <select id="gender" required>
                    <option value="" disabled {% if not defaults %}selected{% endif %}>Select</option>
                    <option value="1" {% if defaults and defaults.gender == 1 %}selected{% endif %}>Male</option>
                    <option value="0" {% if defaults and defaults.gender == 0 %}selected{% endif %}>Female</option>
                </select>
            </div>

            <div class="form-group">
                <label for="age">Age:</label>
                <input type="number" id="age" value="{{ defaults.age if defaults else '' }}" required>
            </div>

            <div class="form-group">
                <label for="bmi">BMI Category:</label>
                <select id="bmi" required>
                    <option value="" disabled {% if not defaults %}selected{% endif %}>Select</option>
                    <option value="0" {% if defaults and defaults.bmi_category == 0 %}selected{% endif %}>Normal</option>
                    <option value="1" {% if defaults and defaults.bmi_category == 1 %}selected{% endif %}>Overweight</option>
                    <option value="2" {% if defaults and defaults.bmi_category == 2 %}selected{% endif %}>Obese</option>
                </select>
            </div>
        </div>

        <div class="form-column">
            <h3><i class="fas fa-moon"></i> Sleep & Activity</h3>
            
            <div class="form-group">
                <label>Duration (h)</label>
                <input type="number" step="0.1" id="duration" placeholder="e.g. 7.5" required>
            </div>

            <div class="form-group">
                <label for="quality">
                    Quality: <span id="qVal" class="val-display text-green">5</span>/10
                </label>
                <input type="range" id="quality" min="1" max="10" value="5" class="slider-full"
                       oninput="
                           document.getElementById('qVal').innerText = this.value; 
                           document.getElementById('qVal').className = (this.value < 5) ? 'val-display text-red' : 'val-display text-green';
                       ">
                <div class="slider-legend">
                    <span>Poor</span><span>Excellent</span>
                </div>
            </div>

            <div class="form-group">
                <label for="stress">
                    Stress: <span id="sVal" class="val-display text-red">5</span>/10
                </label>
                <input type="range" id="stress" min="1" max="10" value="5" class="slider-full"
                       oninput="
                           document.getElementById('sVal').innerText = this.value; 
                           document.getElementById('sVal').className = (this.value < 5) ? 'val-display text-green' : 'val-display text-red';
                       ">
                <div class="slider-legend">
                    <span>Low</span><span>High</span>
                </div>
            </div>

            <div class="form-group">
                <label>Activity (mins)</label>
                <input type="number" id="activity" required>
            </div>
            
            <div class="form-group">
                <label>Daily Steps</label>
                <input type="number" id="daily_steps" required>
            </div>
        </div>

        <div class="form-column">
            <h3><i class="fas fa-heartbeat"></i> Vitals</h3>
            <div class="form-group"><label>Systolic BP</label><input type="number" id="bp_sys" placeholder="e.g. 120" required></div>
            <div class="form-group"><label>Diastolic BP</label><input type="number" id="bp_dia" placeholder="e.g. 80" required></div>
            <div class="form-group"><label>Heart Rate</label><input type="number" id="heart_rate" placeholder="e.g. 72" required></div>
        </div>
    </div>

    <button type="submit" class="btn-save"><i class="fas fa-save"></i> Save Log</button>
</form>

<div id="dailyTipBox" class="ai-box blue hidden">
    <div class="ai-icon"><i class="fas fa-robot"></i></div>
    <div class="ai-content">
        <h3>AI Sleep Coach:</h3>
        <p id="dailyTipText"></p>
    </div>
</div>

<div id="weeklyBox" class="ai-box green hidden">
    <div class="ai-icon"><i class="fas fa-report"></i></div>
    <div class="ai-content">
        <h3>Weekly Sleep Health Report</h3>
        <p id="predictionResult" class="prediction-text">Analyzing...</p>
        <p id="weeklyAdvice" class="advice-text"></p>
    </div>
</div>
{% endblock %}